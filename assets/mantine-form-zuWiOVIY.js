import{r as e,g as t}from"./mantine-core-7ZfaCqOE.js";const r="undefined"!=typeof window?e.useLayoutEffect:e.useEffect;function n(e,t){r(()=>{if(e)return window.addEventListener(e,t),()=>window.removeEventListener(e,t)},[e])}function a(e,t){e&&function(e){if(!/^[0-9a-zA-Z-]+$/.test(e))throw new Error(`[@mantine/use-form] Form name "${e}" is invalid, it should contain only letters, numbers and dashes`)}(e),n(`mantine-form:${e}:set-field-value`,e=>t.setFieldValue(e.detail.path,e.detail.value)),n(`mantine-form:${e}:set-values`,e=>t.setValues(e.detail)),n(`mantine-form:${e}:set-initial-values`,e=>t.setInitialValues(e.detail)),n(`mantine-form:${e}:set-errors`,e=>t.setErrors(e.detail)),n(`mantine-form:${e}:set-field-error`,e=>t.setFieldError(e.detail.path,e.detail.error)),n(`mantine-form:${e}:clear-field-error`,e=>t.clearFieldError(e.detail)),n(`mantine-form:${e}:clear-errors`,t.clearErrors),n(`mantine-form:${e}:reset`,t.reset),n(`mantine-form:${e}:validate`,t.validate),n(`mantine-form:${e}:validate-field`,e=>t.validateField(e.detail)),n(`mantine-form:${e}:reorder-list-item`,e=>t.reorderListItem(e.detail.path,e.detail.payload)),n(`mantine-form:${e}:remove-list-item`,e=>t.removeListItem(e.detail.path,e.detail.index)),n(`mantine-form:${e}:insert-list-item`,e=>t.insertListItem(e.detail.path,e.detail.item,e.detail.index)),n(`mantine-form:${e}:set-dirty`,e=>t.setDirty(e.detail)),n(`mantine-form:${e}:set-touched`,e=>t.setTouched(e.detail)),n(`mantine-form:${e}:reset-dirty`,e=>t.resetDirty(e.detail)),n(`mantine-form:${e}:reset-touched`,t.resetTouched)}function s(e){return null===e||"object"!=typeof e?{}:Object.keys(e).reduce((t,r)=>{const n=e[r];return null!=n&&!1!==n&&(t[r]=n),t},{})}function u(e,t){if(null===t||"object"!=typeof t)return{};const r={...t};return Object.keys(t).forEach(t=>{t.includes(`${String(e)}.`)&&delete r[t]}),r}function l(e,t){const r=e.substring(t.length+1).split(".")[0];return parseInt(r,10)}function o(e,t,r,n){if(void 0===t)return r;const a=`${String(e)}`;let s=r;-1===n&&(s=u(`${a}.${t}`,s));const o={...s},i=new Set;return Object.entries(s).filter(([e])=>{if(!e.startsWith(`${a}.`))return!1;const r=l(e,a);return!Number.isNaN(r)&&r>=t}).forEach(([e,t])=>{const r=l(e,a),s=e.replace(`${a}.${r}`,`${a}.${r+n}`);o[s]=t,i.add(s),i.has(e)||delete o[e]}),o}function i(e,t,r){"object"==typeof r.value&&(r.value=c(r.value)),r.enumerable&&!r.get&&!r.set&&r.configurable&&r.writable&&"__proto__"!==t?e[t]=r.value:Object.defineProperty(e,t,r)}function c(e){if("object"!=typeof e)return e;var t,r,n,a=0,s=Object.prototype.toString.call(e);if("[object Object]"===s?n=Object.create(e.__proto__||null):"[object Array]"===s?n=Array(e.length):"[object Set]"===s?(n=new Set,e.forEach(function(e){n.add(c(e))})):"[object Map]"===s?(n=new Map,e.forEach(function(e,t){n.set(c(t),c(e))})):"[object Date]"===s?n=new Date(+e):"[object RegExp]"===s?n=new RegExp(e.source,e.flags):"[object DataView]"===s?n=new e.constructor(c(e.buffer)):"[object ArrayBuffer]"===s?n=e.slice(0):"Array]"===s.slice(-6)&&(n=new e.constructor(e)),n){for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)i(n,r[a],Object.getOwnPropertyDescriptor(e,r[a]));for(a=0,r=Object.getOwnPropertyNames(e);a<r.length;a++)Object.hasOwnProperty.call(n,t=r[a])&&n[t]===e[t]||i(n,t,Object.getOwnPropertyDescriptor(e,t))}return n||e}function f(e){return"string"!=typeof e?[]:e.split(".")}function d(e,t){const r=f(e);if(0===r.length||"object"!=typeof t||null===t)return;let n=t[r[0]];for(let a=1;a<r.length&&null!=n;a+=1)n=n[r[a]];return n}function p(e,t,r){const n=f(e);if(0===n.length)return r;const a=c(r);if(1===n.length)return a[n[0]]=t,a;let s=a[n[0]];for(let u=1;u<n.length-1;u+=1){if(void 0===s)return a;s=s[n[u]]}return s[n[n.length-1]]=t,a}function h(e,{from:t,to:r},n){const a=d(e,n);if(!Array.isArray(a))return n;const s=[...a],u=a[t];return s.splice(t,1),s.splice(r,0,u),p(e,s,n)}function b(e,t,r,n){const a=d(e,n);if(!Array.isArray(a))return n;const s=[...a];return s.splice("number"==typeof r?r:s.length,0,t),p(e,s,n)}function y(e,t,r){const n=d(e,r);return Array.isArray(n)?p(e,n.filter((e,r)=>r!==t),r):r}function m(e,t,r,n){const a=d(e,n);if(!Array.isArray(a))return n;if(a.length<=r)return n;const s=[...a];return s[r]=t,p(e,s,n)}function v({$values:t,$errors:r,$status:n}){return{reorderListItem:e.useCallback((e,a)=>{n.clearFieldDirty(e),r.setErrors(t=>function(e,{from:t,to:r},n){const a=`${e}.${t}`,s=`${e}.${r}`,u={...n};return Object.keys(n).every(e=>{let t,r;if(e.startsWith(a)&&(t=e,r=e.replace(a,s)),e.startsWith(s)&&(t=e.replace(s,a),r=e),t&&r){const e=u[t],n=u[r];return void 0===n?delete u[t]:u[t]=n,void 0===e?delete u[r]:u[r]=e,!1}return!0}),u}(e,a,t)),t.setValues({values:h(e,a,t.refValues.current),updateState:!0})},[]),removeListItem:e.useCallback((e,a)=>{n.clearFieldDirty(e),r.setErrors(t=>o(e,a,t,-1)),t.setValues({values:y(e,a,t.refValues.current),updateState:!0})},[]),insertListItem:e.useCallback((e,a,s)=>{n.clearFieldDirty(e),r.setErrors(t=>o(e,s,t,1)),t.setValues({values:b(e,a,s,t.refValues.current),updateState:!0})},[]),replaceListItem:e.useCallback((e,r,a)=>{n.clearFieldDirty(e),t.setValues({values:m(e,a,r,t.refValues.current),updateState:!0})},[])}}var g,V;const E=t(V?g:(V=1,g=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,a,s;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(a=n;0!==a--;)if(!e(t[a],r[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(s=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(a=n;0!==a--;)if(!Object.prototype.hasOwnProperty.call(r,s[a]))return!1;for(a=n;0!==a--;){var u=s[a];if(!e(t[u],r[u]))return!1}return!0}return t!=t&&r!=r}));function k(e,t){const r=Object.keys(e);if("string"==typeof t){const n=r.filter(e=>e.startsWith(`${t}.`));return e[t]||n.some(t=>e[t])||!1}return r.some(t=>e[t])}function S(e,t){return e?`${e}-${t.toString()}`:t.toString()}const $=Symbol("root-rule");function C(e){const t=s(e);return{hasErrors:Object.keys(t).length>0,errors:t}}function j(e,t,r="",n={}){return"object"!=typeof e||null===e?n:Object.keys(e).reduce((n,a)=>{const s=e[a],u=`${""===r?"":`${r}.`}${a}`,l=d(u,t);let o=!1;return"function"==typeof s&&(n[u]=s(l,t,u)),"object"==typeof s&&Array.isArray(l)&&(o=!0,l.forEach((e,r)=>j(s,t,`${u}.${r}`,n)),$ in s&&(n[u]=s[$](l,t,u))),"object"==typeof s&&"object"==typeof l&&null!==l&&(o||j(s,t,u,n),$ in s&&(n[u]=s[$](l,t,u))),n},n)}function F(e,t){return C("function"==typeof e?e(t):j(e,t))}function O(e,t,r){if("string"!=typeof e)return{hasError:!1,error:null};const n=F(t,r),a=Object.keys(n.errors).find(t=>e.split(".").every((e,r)=>e===t.split(".")[r]));return{hasError:!!a,error:a?n.errors[a]:null}}function D(e,t){return!!t&&("boolean"==typeof t?t:!!Array.isArray(t)&&t.includes(e.replace(/[.][0-9]+/g,".__MANTINE_FORM_INDEX__")))}function w({name:t,mode:r="controlled",initialValues:n,initialErrors:l={},initialDirty:o={},initialTouched:i={},clearInputErrorOnChange:c=!0,validateInputOnChange:f=!1,validateInputOnBlur:h=!1,onValuesChange:b,transformValues:y=e=>e,enhanceGetInputProps:m,validate:g,onSubmitPreventDefault:V="always",touchTrigger:$="change"}={}){const C=function(t){const[r,n]=e.useState(s(t)),a=e.useRef(r),u=e.useCallback(e=>{n(t=>{const r=s("function"==typeof e?e(t):e);return a.current=r,r})},[]),l=e.useCallback(()=>u({}),[]),o=e.useCallback(e=>{void 0!==a.current[e]&&u(t=>{const r={...t};return delete r[e],r})},[r]),i=e.useCallback((e,t)=>{null==t||!1===t?o(e):a.current[e]!==t&&u(r=>({...r,[e]:t}))},[r]);return{errorsState:r,setErrors:u,clearErrors:l,setFieldError:i,clearFieldError:o}}(l),j=function({initialValues:t,onValuesChange:r,mode:n}){const a=e.useRef(!1),[s,u]=e.useState(t||{}),l=e.useRef(s),o=e.useRef(s),i=e.useCallback(({values:e,subscribers:t,updateState:n=!0,mergeWithPreviousValues:a=!0})=>{const s=l.current,o=e instanceof Function?e(l.current):e,i=a?{...s,...o}:o;l.current=i,n&&u(i),null==r||r(i,s),null==t||t.filter(Boolean).forEach(e=>e({updatedValues:i,previousValues:s}))},[r]),c=e.useCallback(e=>{var t;const r=d(e.path,l.current),n=e.value instanceof Function?e.value(r):e.value;if(r!==n){const r=l.current,a=p(e.path,n,l.current);i({values:a,updateState:e.updateState}),null==(t=e.subscribers)||t.filter(Boolean).forEach(t=>t({path:e.path,updatedValues:a,previousValues:r}))}},[i]),f=e.useCallback(e=>{o.current=e},[]),h=e.useCallback((e,t)=>{a.current||(a.current=!0,i({values:e,updateState:"controlled"===n}),f(e),t())},[i]),b=e.useCallback(()=>{i({values:o.current,updateState:!0,mergeWithPreviousValues:!1})},[i]),y=e.useCallback(()=>l.current,[]),m=e.useCallback(()=>o.current,[]);return{initialized:a,stateValues:s,refValues:l,valuesSnapshot:o,setValues:i,setFieldValue:c,resetValues:b,setValuesSnapshot:f,initialize:h,getValues:y,getValuesSnapshot:m}}({initialValues:n,onValuesChange:b,mode:r}),w=function({initialDirty:t,initialTouched:r,mode:n,$values:a}){const[s,l]=e.useState(r),[o,i]=e.useState(t),c=e.useRef(r),f=e.useRef(t),p=e.useCallback(e=>{const t="function"==typeof e?e(c.current):e;c.current=t,"controlled"===n&&l(t)},[]),h=e.useCallback((e,t=!1)=>{const r="function"==typeof e?e(f.current):e;f.current=r,("controlled"===n||t)&&i(r)},[]),b=e.useCallback(()=>p({}),[]),y=e.useCallback(e=>{const t=e?{...a.refValues.current,...e}:a.refValues.current;a.setValuesSnapshot(t),h({})},[]),m=e.useCallback((e,t)=>{p(r=>k(r,e)===t?r:{...r,[e]:t})},[]),v=e.useCallback((e,t,r)=>{h(r=>k(r,e)===t?r:{...r,[e]:t},r)},[]),g=e.useCallback((e,t)=>{const r=k(f.current,e),n=!E(d(e,a.getValuesSnapshot()),t),s=u(e,f.current);s[e]=n,h(s,r!==n)},[]),V=e.useCallback(e=>k(c.current,e),[]),S=e.useCallback(e=>h(t=>{if("string"!=typeof e)return t;const r=u(e,t);return delete r[e],E(r,t)?t:r}),[]),$=e.useCallback(e=>{if(e){const t=d(e,f.current);if("boolean"==typeof t)return t;const r=d(e,a.refValues.current),n=d(e,a.valuesSnapshot.current);return!E(r,n)}return Object.keys(f.current).length>0?k(f.current):!E(a.refValues.current,a.valuesSnapshot.current)},[]),C=e.useCallback(()=>f.current,[]),j=e.useCallback(()=>c.current,[]);return{touchedState:s,dirtyState:o,touchedRef:c,dirtyRef:f,setTouched:p,setDirty:h,resetDirty:y,resetTouched:b,isTouched:V,setFieldTouched:m,setFieldDirty:v,setTouchedState:l,setDirtyState:i,clearFieldDirty:S,isDirty:$,getDirty:C,getTouched:j,setCalculatedFieldDirty:g}}({initialDirty:o,initialTouched:i,$values:j,mode:r}),T=v({$values:j,$errors:C,$status:w}),I=function({$status:t}){const r=e.useRef({}),n=e.useCallback((t,n)=>{e.useEffect(()=>(r.current[t]=r.current[t]||[],r.current[t].push(n),()=>{r.current[t]=r.current[t].filter(e=>e!==n)}),[n])},[]),a=e.useCallback(e=>r.current[e]?r.current[e].map(r=>n=>r({previousValue:d(e,n.previousValues),value:d(e,n.updatedValues),touched:t.isTouched(e),dirty:t.isDirty(e)})):[],[]);return{subscribers:r,watch:n,getFieldSubscribers:a}}({$status:w}),[A,L]=e.useState(0),[P,R]=e.useState({}),[_,x]=e.useState(!1),N=e.useCallback(()=>{j.resetValues(),C.clearErrors(),w.resetDirty(),w.resetTouched(),"uncontrolled"===r&&L(e=>e+1)},[]),z=e.useCallback(e=>{c&&C.clearErrors(),"uncontrolled"===r&&L(e=>e+1),Object.keys(I.subscribers.current).forEach(t=>{d(t,j.refValues.current)!==d(t,e)&&I.getFieldSubscribers(t).forEach(t=>t({previousValues:e,updatedValues:j.refValues.current}))})},[c]),M=e.useCallback(e=>{const t=j.refValues.current;j.initialize(e,()=>"uncontrolled"===r&&L(e=>e+1)),z(t)},[z]),W=e.useCallback((e,t,n)=>{const a=D(e,f),s=t instanceof Function?t(d(e,j.refValues.current)):t;w.setCalculatedFieldDirty(e,s),"change"===$&&w.setFieldTouched(e,!0),!a&&c&&C.clearFieldError(e),j.setFieldValue({path:e,value:t,updateState:"controlled"===r,subscribers:[...I.getFieldSubscribers(e),a?t=>{const r=O(e,g,t.updatedValues);r.hasError?C.setFieldError(e,r.error):C.clearFieldError(e)}:null,!1!==(null==n?void 0:n.forceUpdate)&&"controlled"!==r?()=>R(t=>({...t,[e]:(t[e]||0)+1})):null]})},[b,g]),B=e.useCallback(e=>{const t=j.refValues.current;j.setValues({values:e,updateState:"controlled"===r}),z(t)},[b,z]),H=e.useCallback(()=>{const e=F(g,j.refValues.current);return C.setErrors(e.errors),e},[g]),U=e.useCallback(e=>{const t=O(e,g,j.refValues.current);return t.hasError?C.setFieldError(e,t.error):C.clearFieldError(e),t},[g]),q=e.useCallback(e=>{e.preventDefault(),N()},[]),G=e.useCallback(e=>e?!O(e,g,j.refValues.current).hasError:!F(g,j.refValues.current).hasErrors,[g]),X=e.useCallback(e=>document.querySelector(`[data-path="${S(t,e)}"]`),[]),Z={watch:I.watch,initialized:j.initialized.current,values:j.stateValues,getValues:j.getValues,setInitialValues:j.setValuesSnapshot,initialize:M,setValues:B,setFieldValue:W,submitting:_,setSubmitting:x,errors:C.errorsState,setErrors:C.setErrors,setFieldError:C.setFieldError,clearFieldError:C.clearFieldError,clearErrors:C.clearErrors,resetDirty:w.resetDirty,setTouched:w.setTouched,setDirty:w.setDirty,isTouched:w.isTouched,resetTouched:w.resetTouched,isDirty:w.isDirty,getTouched:w.getTouched,getDirty:w.getDirty,reorderListItem:T.reorderListItem,insertListItem:T.insertListItem,removeListItem:T.removeListItem,replaceListItem:T.replaceListItem,reset:N,validate:H,validateField:U,getInputProps:(e,{type:n="input",withError:a=!0,withFocus:s=!0,...u}={})=>{var l;const o={onChange:(l=t=>W(e,t,{forceUpdate:!1}),e=>{if(e)if("function"==typeof e)l(e);else if("object"==typeof e&&"nativeEvent"in e){const{currentTarget:t}=e;t instanceof HTMLInputElement?"checkbox"===t.type?l(t.checked):l(t.value):(t instanceof HTMLTextAreaElement||t instanceof HTMLSelectElement)&&l(t.value)}else l(e);else l(e)}),"data-path":S(t,e)};return a&&(o.error=C.errorsState[e]),"checkbox"===n?o["controlled"===r?"checked":"defaultChecked"]=d(e,j.refValues.current):o["controlled"===r?"value":"defaultValue"]=d(e,j.refValues.current),s&&(o.onFocus=()=>w.setFieldTouched(e,!0),o.onBlur=()=>{if(D(e,h)){const t=O(e,g,j.refValues.current);t.hasError?C.setFieldError(e,t.error):C.clearFieldError(e)}}),Object.assign(o,null==m?void 0:m({inputProps:o,field:e,options:{type:n,withError:a,withFocus:s,...u},form:Z}))},onSubmit:(e,t)=>r=>{"always"===V&&(null==r||r.preventDefault());const n=H();if(n.hasErrors)"validation-failed"===V&&(null==r||r.preventDefault()),null==t||t(n.errors,j.refValues.current,r);else{const t=null==e?void 0:e(y(j.refValues.current),r);t instanceof Promise&&(x(!0),t.finally(()=>x(!1)))}},onReset:q,isValid:G,getTransformedValues:e=>y(e||j.refValues.current),key:e=>`${A}-${e}-${P[e]||0}`,getInputNode:X};return a(t,Z),Z}export{w as u};
